import{_ as C,r as l,a as x,c as f,b as e,w as i,v as u,t as c,F as y,d as M,o as h}from"./index-BUOmST_B.js";import{m as q}from"./mqtt.esm-B6YgMEGc.js";const D={class:"container"},F={class:"config-section"},S={class:"input-group"},L={class:"operation-section"},E={class:"subscription"},I={class:"input-group"},N=["disabled"],Q={class:"publish"},$={class:"input-group"},j=["disabled"],z={class:"message-section"},A={class:"message-list"},G={class:"timestamp"},H={class:"topic"},J={class:"content"},K={__name:"test",setup(O){const d=l("ws://your-broker:8083/mqtt"),_=l(""),b=l(""),n=l(""),p=l(""),r=l(""),a=l(!1),g=l(""),v=x([]);let o=null;const T=()=>{if(a.value)k();else{if(!d.value){alert("请输入服务器地址");return}w()}},w=()=>{const m={clean:!0,connectTimeout:4e3,username:_.value,password:b.value};o=q.connect(d.value,m),o.on("connect",()=>{a.value=!0,console.log("认证连接成功")}),o.on("message",(s,t)=>{v.push({timestamp:new Date().toLocaleTimeString(),topic:s,message:t.toString()})}),o.on("error",s=>{console.error("认证失败:",s),alert(`连接错误: ${s.message}`),k()})},k=()=>{o&&(o.end(),a.value=!1,g.value="",v.splice(0,v.length))},U=()=>{n.value&&o&&o.subscribe(n.value,m=>{m||(g.value=n.value,n.value="")})},V=()=>{p.value&&r.value&&o&&(o.publish(p.value,r.value),r.value="")};return(m,s)=>(h(),f("div",D,[e("div",F,[s[6]||(s[6]=e("h2",null,"MQTT 连接配置",-1)),e("div",S,[i(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t),placeholder:"mqtt://broker.url:port"},null,512),[[u,d.value]]),i(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>_.value=t),placeholder:"用户名"},null,512),[[u,_.value]]),i(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>b.value=t),type:"password",placeholder:"密码"},null,512),[[u,b.value]]),e("button",{onClick:T},c(a.value?"断开连接":"连接"),1)])]),e("div",L,[e("div",E,[s[7]||(s[7]=e("h3",null,"订阅主题",-1)),e("div",I,[i(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>n.value=t),placeholder:"输入订阅主题"},null,512),[[u,n.value]]),e("button",{onClick:U,disabled:!a.value},"订阅",8,N)])]),e("div",Q,[s[8]||(s[8]=e("h3",null,"发布消息",-1)),e("div",$,[i(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>p.value=t),placeholder:"输入发布主题"},null,512),[[u,p.value]]),i(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>r.value=t),placeholder:"输入消息内容"},null,512),[[u,r.value]]),e("button",{onClick:V,disabled:!a.value},"发布",8,j)])])]),e("div",z,[e("h3",null,"接收到的消息（主题: "+c(g.value)+"）",1),e("div",A,[(h(!0),f(y,null,M(v,(t,B)=>(h(),f("div",{key:B,class:"message-item"},[e("span",G,c(t.timestamp),1),e("span",H,"["+c(t.topic)+"]",1),e("span",J,c(t.message),1)]))),128))])])]))}},W=C(K,[["__scopeId","data-v-e3efc221"]]);export{W as default};
