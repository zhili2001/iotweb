import{_ as A,u as C,a as P,p as d,r as v,l as x,c as l,b as t,F as r,d as u,m as y,o as n,t as c}from"./index-BUOmST_B.js";const S={class:"automation-view"},B={class:"summary"},F={class:"section"},M={class:"label"},z={class:"value"},D={class:"section"},E={class:"label"},L={class:"value"},G={class:"section"},N={class:"label"},R={class:"value"},V={class:"automation-view"},q={class:"summary"},H={class:"section"},J={class:"label"},K={class:"value"},Q={class:"api-section"},T={class:"api-list"},U=["href","download"],W={__name:"iothome",setup(X){const h=C(),i=P({}),f=s=>(s==null?void 0:s.replace(/[^a-fA-F0-9]/g,"").toLowerCase())||"",g=async()=>{try{const s=await y.get("/api/iot/devices",{params:{userId:h.userId}});Object.entries(s.data).forEach(([a,e])=>{const o=f(a);i[o]={...e,normalizedMac:o,alias:e.mac_alias||o,keys:e.keys.map(_=>({..._,alias:_.key_alias||_.mac_key}))}})}catch(s){console.error("获取设备失败:",s)}},k=d(()=>({当前在线网关数:Object.values(i).filter(s=>s.is_online).length,当前离线网关数:Object.values(i).filter(s=>!s.is_online).length})),I=d(()=>({已确认网关数量:Object.values(i).filter(s=>s.mac_alias).length,未知网关数量:Object.values(i).filter(s=>!s.mac_alias).length})),b=d(()=>({已确认设备数量:Object.values(i).reduce((s,a)=>s+a.keys.filter(e=>e.key_alias).length,0),未知设备数量:Object.values(i).reduce((s,a)=>s+a.keys.filter(e=>!e.key_alias).length,0)})),p=v(0),m=v(0),w=d(()=>({收到数据条数:p.value,发送数据条数:m.value})),O=async()=>{try{const s=await y.post("/api/iot/get_record_count",{userId:h.userId});p.value=s.data.total_gather_count,m.value=s.data.total_operate_count}catch(s){console.error("获取数据条数失败:",s)}};x(()=>{g(),O()});const j=v([{name:"硬件接入API",path:"./files/硬件接入API.pdf"},{name:"客户端开发API",path:"./files/客户端开发API.pdf"}]);return(s,a)=>(n(),l("div",null,[t("div",S,[t("div",B,[t("div",F,[a[0]||(a[0]=t("h3",{class:"section-title"},"网关在线情况",-1)),(n(!0),l(r,null,u(k.value,(e,o)=>(n(),l("div",{class:"card",key:o},[t("p",M,c(o),1),t("p",z,c(e),1)]))),128))]),t("div",D,[a[1]||(a[1]=t("h3",{class:"section-title"},"网关数量",-1)),(n(!0),l(r,null,u(I.value,(e,o)=>(n(),l("div",{class:"card",key:o},[t("p",E,c(o),1),t("p",L,c(e),1)]))),128))]),t("div",G,[a[2]||(a[2]=t("h3",{class:"section-title"},"设备数量",-1)),(n(!0),l(r,null,u(b.value,(e,o)=>(n(),l("div",{class:"card",key:o},[t("p",N,c(o),1),t("p",R,c(e),1)]))),128))])])]),t("div",V,[t("div",q,[t("div",H,[a[3]||(a[3]=t("h3",{class:"section-title"},"数据条数",-1)),(n(!0),l(r,null,u(w.value,(e,o)=>(n(),l("div",{class:"card",key:o},[t("p",J,c(o),1),t("p",K,c(e),1)]))),128))])])]),t("div",Q,[a[4]||(a[4]=t("h3",{class:"api-title"},"平台API接口",-1)),t("ul",T,[(n(!0),l(r,null,u(j.value,e=>(n(),l("li",{key:e.name,class:"api-item"},[t("a",{href:e.path,download:e.name,class:"api-link"},c(e.name),9,U)]))),128))])])]))}},Z=A(W,[["__scopeId","data-v-be8282ea"]]);export{Z as default};
